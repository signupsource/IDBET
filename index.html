<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>تسجيل الدخول</title>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet" />
  <style>
    :root { --header-h:64px; --brand:#e50914; }
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:'Tajawal',sans-serif;background:#f5f5f5;direction:rtl;color:#333}
    header{height:var(--header-h);background:#fff;display:flex;align-items:center;padding:0 20px;box-shadow:0 2px 6px rgba(0,0,0,.05);border-bottom:1px solid #eee}
    .header-brand{display:flex;align-items:center;gap:10px;font-weight:500}
    .idbet{color:var(--brand);font-size:1.15rem;font-weight:700}
    .separator{color:#ccc}
    .slogan{color:#555;font-size:.9rem}
    main{display:flex;justify-content:center;padding:28px 14px}
    .login-box{background:#fff;padding:28px 20px;max-width:360px;width:100%;box-shadow:0 3px 14px rgba(0,0,0,.08)}
    .title-wrapper{display:flex;align-items:center;gap:8px;font-size:1.25rem;font-weight:700;margin-bottom:16px}
    .step-box{width:32px;height:32px;border-radius:50%;background:var(--brand);color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:.95rem}
    .input-label{margin-bottom:6px;font-weight:600;display:flex;align-items:center;gap:6px;font-size:.92rem}
    .info-icon{width:22px;height:22px;border:2px solid #666;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:.95rem;color:#666;cursor:help;transition:.3s}
    .info-icon:hover{border-color:var(--brand);background:rgba(229,9,20,.1);color:var(--brand)}
    .input-group{margin-bottom:14px}
    .input-group input{width:100%;padding:9px;font-size:.9rem;border:1px solid #ccc;border-radius:8px;outline:none}
    .error-message{font-size:.8rem;margin-top:5px;min-height:20px;transition:color .3s}
    .platform-icons{display:grid;grid-template-columns:repeat(3,1fr);gap:14px;justify-items:center;margin:18px 0}
    .icon{position:relative;width:80px;height:80px;border-radius:10px;background:#fff;box-shadow:0 2px 6px rgba(0,0,0,.05);display:flex;flex-direction:column;align-items:center;justify-content:center;padding:8px;border:1px solid #eee;cursor:pointer;transition:.25s}
    .icon:hover{transform:translateY(-2px) scale(1.03);box-shadow:0 5px 12px rgba(0,0,0,.1)}
    .icon.selected{border-color:var(--brand);box-shadow:0 0 8px rgba(229,9,20,.25)}
    .icon.selected::after{content:"✓";position:absolute;top:4px;left:4px;width:16px;height:16px;background:var(--brand);color:#fff;border-radius:50%;font-size:9px;display:flex;align-items:center;justify-content:center}
    .icon img{height:36px;max-width:90%;object-fit:contain}
    .icon-name{margin-top:4px;font-weight:600;font-size:.75rem;color:#333;text-align:center}
    .login-btn{background:var(--brand);color:#fff;font-weight:700;border:none;padding:9px 14px;width:100%;border-radius:8px;cursor:pointer;transition:.25s}
    .login-btn:disabled{background:#ccc;cursor:not-allowed}
    .login-btn:hover:not(:disabled){background:#b20710}
    .btn-spinner{display:inline-block;border-radius:50%;animation:spin .8s linear infinite;width:14px;height:14px;border:3px solid rgba(255,255,255,.6);border-top:3px solid #fff;margin-right:5px}
    @keyframes spin{to{transform:rotate(360deg)}}
  </style>
</head>
<body>

<header>
  <div class="header-brand">
    <span class="idbet">Idbet</span><span class="separator">|</span><span class="slogan">وكيل الشحن الرسمي</span>
  </div>
</header>

<main>
  <section class="login-box">
    <div class="title-wrapper"><div class="step-box">1</div><h2>تسجيل الدخول</h2></div>

    <div class="input-label">
      <label for="player-id-1">معرّف اللاعب</label>
      <span class="info-icon" title="رقم مكوَّن من 10 أرقام">?</span>
    </div>

    <div class="input-group">
      <input id="player-id-1" type="text" placeholder="أدخل المعرّف الـ ID" maxlength="10" />
      <div class="error-message" id="error-message"></div>
    </div>

    <div class="platform-icons" id="platforms">
      <div class="icon" data-name="LineBet"><img src="https://i.postimg.cc/x1p0KbfL/cropped-linebet-logo.png" alt="LineBet"><div class="icon-name">LineBet</div></div>
      <div class="icon" data-name="MegaPari"><img src="https://i.postimg.cc/3RRJsCtS/Wh7-Gu-Bom34-Xq4-Bu-QN5n-Qlj-XPXf-V6-CZothm-Lsl6a-S.webp" alt="MegaPari"><div class="icon-name">MegaPari</div></div>
      <div class="icon" data-name="Melbet"><img src="https://i.postimg.cc/wjCr86FS/melbet.png" alt="Melbet"><div class="icon-name">Melbet</div></div>
      <div class="icon" data-name="Gooobet"><img src="https://i.postimg.cc/NMyXmrWn/c943dc665c7e8926e8fb15cadd4e1eee.jpg" alt="Gooobet"><div class="icon-name">Gooobet</div></div>
      <div class="icon" data-name="1xBet"><img src="https://i.postimg.cc/PrMCL4Cx/1-XBet-Casino-1200x900-1.png" alt="1xBet"><div class="icon-name">1xBet</div></div>
    </div>

    <button class="login-btn" id="login-btn" disabled>تسجيل الدخول</button>
  </section>
</main>

<script>
const input = document.getElementById('player-id-1');
const errMsg = document.getElementById('error-message');
const btn = document.getElementById('login-btn');
let platform = null;

document.querySelectorAll('.icon').forEach(icon => {
  icon.addEventListener('click', () => {
    platform = icon.dataset.name;
    document.querySelectorAll('.icon').forEach(i => i.classList.remove('selected'));
    icon.classList.add('selected');
    validate();
  });
});

input.addEventListener('input', () => {
  input.value = input.value.replace(/\D/g, '');
  validate();
});

function validate() {
  const val = input.value;
  if (val.length === 10 && platform) {
    errMsg.textContent = "جاهز للإرسال";
    errMsg.style.color = "green";
    btn.disabled = false;
  } else {
    errMsg.textContent = "أدخل معرفًا صحيحًا واختر المنصة";
    errMsg.style.color = "var(--brand)";
    btn.disabled = true;
  }
}

btn.addEventListener('click', async (e) => {
  e.preventDefault();
  const userId = input.value;
  if (!userId || userId.length !== 10 || !platform) return;

  btn.disabled = true;
  btn.innerHTML = '<span class="btn-spinner"></span> إرسال...';

  const payload = {
    userId: userId,
    platform: platform
  };

  try {
    const res = await fetch("https://script.google.com/macros/s/AKfycbx5eBtV9miCzU9nk2oHtZk5hizvzE2U23aph7_g_tkf_8SiEyzxwRgRd5XRiBQ3-a35pQ/exec", {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify(payload)
    });

    const result = await res.json();
    if (result.status === 'success') {
      window.location.href = 'home.html';
    } else {
      btn.innerHTML = 'فشل في الإرسال';
      btn.disabled = false;
    }
  } catch (error) {
    btn.innerHTML = 'فشل الاتصال';
    btn.disabled = false;
  }
});
</script>

</body>
</html>
